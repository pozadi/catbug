/*! catbug 0.1.3
 *  2013-07-28 11:47:59 +0400
 *  http://github.com/pozadi/catbug
 */
(function(t,e,n){t.catbug=function(){return catbug.core.module.apply(catbug,arguments)},catbug.ns=function(t,e){var n,r,i,o,u;for(n=this,u=t.split("."),i=0,o=u.length;o>i;i++)r=u[i],r&&(n=n[r]||(n[r]={}));return e(n,this)},catbug.ns("treeParser",function(t){return t.nonEmpty=/\S+/,t.indentation=/^\s+/,t.selectorAndAttrs=/^([^\{]+)(?:\{(.*?)\})?$/,t.attribute=/([a-z_-]+)(?:=(?:"(.*?)"|'(.*?)'|(\S+)))?/,t.attributes=RegExp(t.attribute.source,"g"),t.comments=/\/\*[\s\S]*?\*\/|\/\/.*/g,t.parseToRaw=function(r){var i,o,u,s,l;return s=function(e){return t.nonEmpty.test(e)},i=function(n){var r;return{level:(null!=(r=t.indentation.exec(n))?r[0].length:void 0)||0,data:e.trim(n)}},l=function(t,e){var r,i,o,u,s;for(null==e&&(e="level"),r=n.min(n.pluck(t,"level")),s=[],o=0,u=t.length;u>o;o++)i=t[o],s.push(i[e]=i.level-r);return s},o=function(t,e){var n,r,i,u,s,a,c;for(l(t,"normLevel"),s=[],r=null,n=function(){var t;return r?(t={data:r.data,level:r.level,parent:e},t.children=o(u,t),s.push(t)):void 0},a=0,c=t.length;c>a;a++)if(i=t[a],i.normLevel>0){if(!r)throw Error("unexpected indent");u.push(i)}else n(),r=i,u=[];return n(),s},r=r.replace(t.comments,""),u=n.chain(r.split("\n")).filter(s).map(i).value(),l(u),o(u,null)},t.flat=function(t){var e,n;return n=[],e=function(t){var r,i,o,u;for(u=[],i=0,o=t.length;o>i;i++)r=t[i],n.push(r),u.push(e(r.children));return u},e(t),n},t.parseAttributes=function(e){var n,r,i,o,u,s,l,a;if(i={},e)for(a=e.match(t.attributes),s=0,l=a.length;l>s;s++)n=a[s],o=t.attribute.exec(n),r=o[1],u=o[4]||o[3]||o[2],i[r]=u;return i},t.parseLine=function(n){var r;if(r=t.selectorAndAttrs.exec(n),!r)throw Error("wrong syntax");return{selector:e.trim(r[1]),attributes:t.parseAttributes(r[2])}},t.selectorToName=function(t){return e.camelCase(t.replace(/[^a-z0-9]+/gi,"-").replace(/^-/,"").replace(/-$/,"").replace(/^js-/,""))},t.genName=function(e){return e.name=e.attributes.name?e.attributes.name:t.selectorToName(e.selector)},t.parse=function(e){var r,i,o,u,s,l;if(o=t.parseToRaw(e),1!==o.length)throw Error("more than one root");for(i=t.flat(o),u=0,s=i.length;s>u;u++)r=i[u],n.extend(r,t.parseLine(r.data)),r.selector=r.selector.replace("&",null!=(l=r.parent)?l.selector:void 0);return n.each(i,t.genName),{root:n.findWhere(i,{level:0}),elements:n.filter(i,function(t){return t.level>0})}}}),catbug.ns("core",function(t){return jQuery.prototype.catbug=function(e){var n;return n=this.get(0),n?t.instances[e].init(n):void 0}}),catbug.ns("jquerySub",function(t){t.sub=function(){function t(e,n){return new t.fn.init(e,n)}e.extend(!0,t,e),t.superclass=e,t.fn=t.prototype=e(),t.fn.constructor=t,t.fn.init=function(r,i){return i&&i instanceof jQuery&&!(i instanceof t)&&(i=t(i)),e.fn.init.call(this,r,i,n)},t.fn.init.prototype=t.fn;var n=t(document);return t}}),catbug.ns("element",function(t,r){var i;return i=function(t){return t.jquery?t.get(0):t},t.jQuery=r.jquerySub.sub(),t.jQuery.prototype.update=function(){var t,n,r,i;for(this.splice(0,this.length),i=e(this.selector,this.context),n=0,r=i.length;r>n;n++)t=i[n],this.push(t);return this},t.jQuery.prototype.byChild=function(t){return t=i(t),this.filter(function(){return e.contains(this,t)})},t.jQuery.prototype.byParent=function(t){return t=i(t),this.filter(function(){return e.contains(t,this)})},t.jQuery.prototype.live=function(t,n,r){return e(this.context).on(t,this.selector,n,r),this},t.jQuery.prototype.die=function(t,n){return e(this.context).off(t,this.selector,n),this},t.Element=function(e,r){return n.extend(t.jQuery(e,r),{selector:e})}});var r=function(t,e){return function(){return t.apply(e,arguments)}};catbug.ns("core",function(t,i){return t.instances={},t.builderContextMixin={update:function(t){var e,n,r,i,o;for(i=t.split(" "),o=[],n=0,r=i.length;r>n;n++)e=i[n],o.push(this[e].update());return o},updateAll:function(){var t,e,n,r,i;for(r=this.__elements,i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(this[t.name].update());return i}},t.copyMethods=["find","on","off","data","addClass","removeClass","toggleClass","hasClass","hide","show","toggle"],t.Module=function(){function o(t,e,n,i){this.name=t,this.rootSelector=e,this.elements=n,this.builder=i,this.initAll=r(this.initAll,this)}return o.prototype.buildElements=function(t){var e,n,r,o,u;for(n={},u=this.elements,r=0,o=u.length;o>r;r++)e=u[r],n[e.name]=i.element.Element(e.selector,t);return n},o.prototype.builderContext=function(e){var r,i,o,u,s;for(i={},s=t.copyMethods,o=0,u=s.length;u>o;o++)r=s[o],i[r]=n.bind(e[r],e);return n.extend(i,{root:e,__elements:this.elements},t.builderContextMixin,this.buildElements(e))},o.prototype.init=function(t){var n,r;return t=e(t),r="catbug-"+this.name,t.data(r)||(n=this.builderContext(t),t.data(r,this.builder.call(n,n))),t.data(r)},o.prototype.initAll=function(){var t,n,r,i,o;for(i=e(this.rootSelector),o=[],n=0,r=i.length;r>n;n++)t=i[n],o.push(this.init(t));return o},o}(),t.module=function(r,o,u){var s;return null==u&&(u=o,o=n.uniqueId("lambda-")),r=i.treeParser.parse(r),t.instances[o]=s=new t.Module(o,r.root.selector,r.elements,u),e(s.initAll)},i.init=function(e){var n,r,i,o,u;for(r={},u=e.split(" "),i=0,o=u.length;o>i;i++)n=u[i],r[n]=t.instances[n].initAll();return r},i.initAll=function(){var e,n,r,i;r={},i=t.instances;for(n in i)e=i[n],r[n]=e.initAll();return r}})})(this,this.jQuery,this._);