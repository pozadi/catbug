/*! catbug 0.1.3
 *  2013-07-28 10:26:04 +0400
 *  http://github.com/pozadi/catbug
 */
(function(t){t.catbug=function(){return catbug.core.module.apply(catbug,arguments)},catbug.ns=function(t,e){var n,r,i,o,u;for(n=this,u=t.split("."),i=0,o=u.length;o>i;i++)r=u[i],r&&(n=n[r]||(n[r]={}));return e(n,this)},catbug.ns("treeParser",function(t){return t.nonEmpty=/\S+/,t.indentation=/^\s+/,t.selectorAndAttrs=/^([^\{]+)(?:\{(.*?)\})?$/,t.attribute=/([a-z_-]+)(?:=(?:"(.*?)"|'(.*?)'|(\S+)))?/,t.attributes=RegExp(t.attribute.source,"g"),t.comments=/\/\*[\s\S]*?\*\/|\/\/.*/g,t.parseToRaw=function(e){var n,r,i,o,u;return o=function(e){return t.nonEmpty.test(e)},n=function(e){var n;return{level:(null!=(n=t.indentation.exec(e))?n[0].length:void 0)||0,data:$.trim(e)}},u=function(t,e){var n,r,i,o,u;for(null==e&&(e="level"),n=_.min(_.pluck(t,"level")),u=[],i=0,o=t.length;o>i;i++)r=t[i],u.push(r[e]=r.level-n);return u},r=function(t,e){var n,i,o,l,s,a,c;for(u(t,"normLevel"),s=[],i=null,n=function(){var t;return i?(t={data:i.data,level:i.level,parent:e},t.children=r(l,t),s.push(t)):void 0},a=0,c=t.length;c>a;a++)if(o=t[a],o.normLevel>0){if(!i)throw Error("unexpected indent");l.push(o)}else n(),i=o,l=[];return n(),s},e=e.replace(t.comments,""),i=_.chain(e.split("\n")).filter(o).map(n).value(),u(i),r(i,null)},t.flat=function(t){var e,n;return n=[],e=function(t){var r,i,o,u;for(u=[],i=0,o=t.length;o>i;i++)r=t[i],n.push(r),u.push(e(r.children));return u},e(t),n},t.parseAttributes=function(e){var n,r,i,o,u,l,s,a;if(i={},e)for(a=e.match(t.attributes),l=0,s=a.length;s>l;l++)n=a[l],o=t.attribute.exec(n),r=o[1],u=o[4]||o[3]||o[2],i[r]=u;return i},t.parseLine=function(e){var n;if(n=t.selectorAndAttrs.exec(e),!n)throw Error("wrong syntax");return{selector:$.trim(n[1]),attributes:t.parseAttributes(n[2])}},t.selectorToName=function(t){return $.camelCase(t.replace(/[^a-z0-9]+/gi,"-").replace(/^-/,"").replace(/-$/,"").replace(/^js-/,""))},t.genName=function(e){return e.name=e.attributes.name?e.attributes.name:t.selectorToName(e.selector)},t.parse=function(e){var n,r,i,o,u,l;if(i=t.parseToRaw(e),1!==i.length)throw Error("more than one root");for(r=t.flat(i),o=0,u=r.length;u>o;o++)n=r[o],_.extend(n,t.parseLine(n.data)),n.selector=n.selector.replace("&",null!=(l=n.parent)?l.selector:void 0);return _.each(r,t.genName),{root:_.findWhere(r,{level:0}),elements:_.filter(r,function(t){return t.level>0})}}}),catbug.ns("core",function(t){return jQuery.prototype.catbug=function(e){var n;return n=this.get(0),n?t.instances[e].init(n):void 0}});var e=function(t,e){return function(){return t.apply(e,arguments)}};catbug.ns("core",function(t,n){var r;return r=function(t){return t.jquery?t.get(0):t},t.instances={},t.elementMixin={update:function(){var t,e,n,r;for(this.splice(0,this.length),r=$(this.selector,this.context),e=0,n=r.length;n>e;e++)t=r[e],this.push(t);return this},byChild:function(t){return t=r(t),this.filter(function(){return $.contains(this,t)})},byParent:function(t){return t=r(t),this.filter(function(){return $.contains(t,this)})},live:function(t,e,n){return $(this.context).on(t,this.selector,e,n),this},die:function(t,e){return $(this.context).off(t,this.selector,e),this}},t.builderContextMixin={update:function(t){var e,n,r,i,o;for(i=t.split(" "),o=[],n=0,r=i.length;r>n;n++)e=i[n],o.push(this[e].update());return o},updateAll:function(){var t,e,n,r,i;for(r=this.__elements,i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(this[t.name].update());return i}},t.copyMethods=["find","on","off","data","addClass","removeClass","toggleClass","hasClass","hide","show","toggle"],t.Module=function(){function n(t,n,r,i){this.name=t,this.rootSelector=n,this.elements=r,this.builder=i,this.initAll=e(this.initAll,this)}return n.prototype.buildElement=function(e,n){return _.extend($(e,n),{selector:e},t.elementMixin)},n.prototype.buildElements=function(t){var e,n,r,i,o;for(n={},o=this.elements,r=0,i=o.length;i>r;r++)e=o[r],n[e.name]=this.buildElement(e.selector,t);return n},n.prototype.builderContext=function(e){var n,r,i,o,u;for(r={},u=t.copyMethods,i=0,o=u.length;o>i;i++)n=u[i],r[n]=_.bind(e[n],e);return _.extend(r,{root:e,__elements:this.elements},t.builderContextMixin,this.buildElements(e))},n.prototype.init=function(t){var e,n;return t=$(t),n="catbug-"+this.name,t.data(n)||(e=this.builderContext(t),t.data(n,this.builder.call(e,e))),t.data(n)},n.prototype.initAll=function(){var t,e,n,r,i;for(r=$(this.rootSelector),i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(this.init(t));return i},n}(),t.module=function(e,r,i){var o;return null==i&&(i=r,r=_.uniqueId("lambda-")),e=n.treeParser.parse(e),t.instances[r]=o=new t.Module(r,e.root.selector,e.elements,i),$(o.initAll)},n.init=function(e){var n,r,i,o,u;for(r={},u=e.split(" "),i=0,o=u.length;o>i;i++)n=u[i],r[n]=t.instances[n].initAll();return r},n.initAll=function(){var e,n,r,i;r={},i=t.instances;for(n in i)e=i[n],r[n]=e.initAll();return r}})})(this);